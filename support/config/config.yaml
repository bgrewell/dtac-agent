---
# Port the service will use to listen for requests
listen_port: 8180

# Service uses https
https: false
# cert_file: /certs/tls.crt
# key_file: /certs/tls.key

# Lockout auto-expire time in seconds
lockout_timeout: 60

watchdog:
  enabled: false
  poll_interval: 10
  profile: NetworkOfFuture
  bssid: not_implemented_yet

# Section for service auto-updater **CURRENTLY DISABLED IN CODE**
updater:
  token: 7888124ef00163d6bddc618bcc627b1a4c0d0564
  mode: auto
  interval: 1m
  error_fallback: 1h
  restart_on_update: true

# Plugins
plugin_dir: /etc/dtac-agent/plugins
plugin_cookie: "this_is_not_a_security_feature"
plugins:
  # TODO: New plugin system doesn't support passing a configuration to the plugin yet. Fix that
  hello.plugin:
    enabled: true
    cookie: "this_is_not_a_security_feature"
    hash: abc123
    config:
      message: "hello world plugin"

# Modules are compiled sections of code that can be selectively enabled
modules:
  - hello:
      message: "hello world module"

# Custom is customer handlers. TODO: Look at replacing these with plugins?
custom:
  - date:
      wrap_json: yes
      source:
        type: cmd
        run_as: intel
        value: date
      methods: ["GET"]

  - whoami:
      route: "/cmds/whoami"
      wrap_json: yes
      source:
        type: cmd
        run_as: sudo
        value: whoami
      methods: ["GET"]

#  - wemo:
#      route: "/wemo/control"
#      wrap_json: no
#      source:
#        type: cmd
#        run_as: intel
#        value: wemo --json ${vars}
#        variables:
#          source: query_params
#          format: "--${key} ${value}"
#          whitelist:
#            latency: "[0-9]{1,4}"
#            jitter: "[0-9]{1,4}"
#            loss: "[-+]?[0-9]*\\.?[0-9]+"
#            reorder: "[-+]?[0-9]*\\.?[0-9]+"
#            corruption: "[-+]?[0-9]*\\.?[0-9]+"
#            duplication: "[-+]?[0-9]*\\.?[0-9]+"
#            rate: "[-+]?[0-9]*\\.?[0-9]+[bkmgBKMG]*"
#      methods: ["GET"]


